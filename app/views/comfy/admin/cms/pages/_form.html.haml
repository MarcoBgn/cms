- content_for :right_column do
  #form-save.box
    %label.checkbox-inline
      %input{:type => 'checkbox'}
      = ::Comfy::Cms::Page.human_attribute_name(:is_published)
    %button.btn.btn-sm.btn-primary.pull-right
  = render 'comfy/admin/cms/files/index'

= render 'comfy/admin/cms/partials/page_form_before', :object => form

.l-panel-content.l-panel-content--form
  .l-constrained
    = form.text_field :label, hide_label: true, :class => 'inline-input inline-input--page-title', :placeholder => 'Untitled page', :data => {:slugify => @page.new_record?}

    - if (options = ::Comfy::Cms::Layout.options_for_select(@site)).present?
      = form.select :layout_id, options, {}, 'data-url' => form_blocks_comfy_admin_cms_site_page_path(@site, @page.id.to_i)

    - unless @site.pages.count == 0 || @site.pages.root == @page
      = form.text_field :slug, :data => {:slug => true}
      - unless @page.new_record?
        = form.text_field :full_path, :id => 'full-path', :disabled => true

    - if (options = ::Comfy::Cms::Page.options_for_select(@site, @page, nil, 0, false)).present?
      = form.select :target_page_id, [["---- #{t('.select_target_page')} ----", nil]] + options

      = render 'comfy/admin/cms/partials/page_form_inner', :object => form

      = render :partial => 'comfy/admin/cms/categories/form', :object => form

= render :partial => 'form_blocks'

.nav-article.is-fixed
  .l-constrained
    .nav-article__inner
      %span.nav-article__item
        %span
          EN Status:
          =current_status(@page.current_state)
      %span.nav-article__item
        %a.button.button--capitalized{:href => '#'}
          Activity Log
      %span.nav-article__item
        %a.button.button--capitalized{:href => '#'}
          Notes

      %span.nav-article__item.nav-article__item--right
        - unless @page.unsaved?
          = link_to t('.preview'), "https://www.moneyadviceservice.org.uk/#{I18n.locale}/articles#{@page.full_path}/preview", :class => 'btn btn-default', id: 'preview', target: '_blank'
        .btn-group.dropup
          = button_tag(class: 'button button--action', "data-toggle" => "dropdown") do
            save
            %span.caret
          %ul{class: 'dropdown-menu', role: 'menu'}
            - page_state_buttons(@page.current_state).each do |state_event|
              %li
                = button_tag state_event[:label], value: state_event[:value], data: state_event[:data], type: 'submit', name: 'state_event', class: 'button button--action'

= render 'comfy/admin/cms/partials/page_form_after', :object => form
